#!/usr/bin/python3

from scapy.all import *
from binascii import hexlify


paquets = rdpcap('capture.pcap') #Leemos todos los paquetes de la captura

paquets = [p for p in paquets if p.dst == 'e8:1b:69:5b:0f:60'] #Filtramos por aquellos paquetes cuya MAC destino sea e8:1b:69:5b:0f:60 

f = open('hexdump.txt', 'a')

for p in paquets:
    hex = p[DNSQR].qname.decode().split(".")[0] #Filtramos lo que nos interesa, cogemos qname y quitamos .pumpkincorp.com.
    f.write(hex)

